<nav class="modern-navbar">
  <div class="navbar-container">
    
    <!-- Brand/Logo -->
    <a class="navbar-brand" 
       [routerLink]="(isAuthenticated$ | async) ? (isAdminLoggedIn ? 'admin/dashboard' : 'user/dashboard') : 'home'">
      <div class="brand-logo">
        <span class="brand-text">GST</span>
        <span class="brand-highlight">Medicose</span>
      </div>
    </a>

    <!-- Mobile Toggle -->
    <button class="navbar-toggle" 
            [class.active]="mobileMenuOpen"
            (click)="toggleMobileMenu()"
            aria-label="Toggle navigation">
      <span class="toggle-line"></span>
      <span class="toggle-line"></span>
      <span class="toggle-line"></span>
    </button>

    <!-- Navigation Links -->
    <div class="navbar-menu" [class.mobile-open]="mobileMenuOpen">
      
      <!-- Logged Out Links -->
      <ul class="nav-list" *ngIf="!(isAuthenticated$ | async)">
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/register" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faUserPlus"></fa-icon>
            <span>Register</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/login" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faSignInAlt"></fa-icon>
            <span>Login</span>
          </a>
        </li>
      </ul>

      <!-- Admin Links -->
      <ul class="nav-list" *ngIf="(isAuthenticated$ | async) && isAdminLoggedIn">
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/admin/dashboard" 
             routerLinkActive="active"
             [routerLinkActiveOptions]="{exact: true}"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faChartLine"></fa-icon>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/admin/add-product" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faBoxOpen"></fa-icon>
            <span>Add Product</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/profile" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faUser"></fa-icon>
            <span>Profile</span>
          </a>
        </li>
        <li class="nav-item">
          <button class="nav-link logout-btn" (click)="logout()">
            <fa-icon [icon]="faSignOutAlt"></fa-icon>
            <span>Logout</span>
          </button>
        </li>
      </ul>

      <!-- User Links -->
      <ul class="nav-list" *ngIf="(isAuthenticated$ | async) && isUserLoggedIn && !isAdminLoggedIn">
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/user/dashboard" 
             routerLinkActive="active"
             [routerLinkActiveOptions]="{exact: true}"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faChartLine"></fa-icon>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/user/add-stock" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faBoxes"></fa-icon>
            <span>Add Stock</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 

            routerLinkActive="active"
            [class.disabled]="!detailsValid"
            [attr.aria-disabled]="!detailsValid"
             (click)="onCreateBill($event)">
            <fa-icon [icon]="faFileInvoice"></fa-icon>
            <span>Create Bill</span>
            <span class="disabled-badge" *ngIf="!detailsValid">Complete Details</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/user/bills" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faMoneyBillWave"></fa-icon>
            <span>Bills</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/user/details" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faBuilding"></fa-icon>
            <span>Details</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="/profile" 
             routerLinkActive="active"
             (click)="closeMobileMenu()">
            <fa-icon [icon]="faUser"></fa-icon>
            <span>Profile</span>
          </a>
        </li>
        <li class="nav-item">
          <button class="nav-link logout-btn" (click)="logout()">
            <fa-icon [icon]="faSignOutAlt"></fa-icon>
            <span>Logout</span>
          </button>
        </li>
      </ul>

    </div>
  </div>
</nav>

<div
  class="mobile-overlay"
  *ngIf="mobileMenuOpen"
  (click)="closeMobileMenu()">
</div>

<!-- Error Alert -->
<div class="navbar-alert-container" *ngIf="errorMessage">
  <div class="alert alert-danger" (click)="errorMessage = null">
    <span class="alert-icon">âš </span>
    {{ errorMessage }}
  </div>
</div>